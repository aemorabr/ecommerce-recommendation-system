name: ML Model Retraining

on:
  schedule:
    # Run every Sunday at 2 AM UTC
    - cron: '0 2 * * 0'
  workflow_dispatch:  # Allow manual trigger

jobs:
  retrain-model:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Trigger model retraining
      run: |
        curl -X POST ${{ secrets.ML_SERVICE_URL }}/retrain \
          -H "Content-Type: application/json"

    - name: Verify model health
      run: |
        curl ${{ secrets.ML_SERVICE_URL }}/health

    - name: Get model metrics
      run: |
        curl ${{ secrets.ML_SERVICE_URL }}/metrics
